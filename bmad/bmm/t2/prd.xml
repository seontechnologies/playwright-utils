<template id="bmad/bmm/templates/prd.md" name="Product Requirements (PRD)" filename="{project-root}{output-directory}/prd.md">

  <title>{{project_name}} Product Requirements Document (PRD)</title>

  <!-- IDE-INJECT-POINT: prd-subagent-instructions -->

  <sections>
    <section id="goals-context" title="Goals and Background Context" status="required">
      <instruction>
        Ask if Project Brief document is available. If NO Project Brief exists, STRONGLY recommend creating one first using brief (it
        provides essential foundation: problem statement, target users, success metrics, MVP scope, constraints).
        If user insists on PRD without brief, gather this information during Goals section.
        If Project Brief exists, review and use it to populate Goals (bullet list of desired outcomes) and Background Context (1-2
        paragraphs on what this solves and why) so we can determine what is and is not in scope for PRD MVP.
        Either way this is critical to determine the requirements.
        Include Change Log table.
      </instruction>

      <sections>
        <section id="goals" title="Goals" status="required">
          <instruction>
            Bullet list of 1 line desired outcomes the PRD will deliver if successful - user and project desires.
            Focus on user and project desires. Be specific and measurable where possible.
          </instruction>
        </section>

        <section id="background" title="Background Context" status="required">
          <instruction>
            1-2 short paragraphs summarizing the background context, such as what we learned in the brief without being redundant with the
            goals, what and why this solves a problem, what the current landscape or need is.
          </instruction>
        </section>

        <section id="changelog" title="Change Log" status="required">
          <instruction>
            Track document versions and changes.
            Create a change log table with columns: Date | Version | Description | Author
            Initialize with first entry for document creation.
          </instruction>
        </section>
      </sections>
    </section>

    <section id="requirements" title="Requirements" status="required" elicit="true">
      <instruction> Draft the list of functional and non functional requirements under the two child sections. Each requirement must be
        specific, testable, and achievable. <llm>
          <i>Reference goals and background to ensure alignment</i>
        </llm>
        <!-- IDE-INJECT-POINT: prd-requirements-analysis -->
      </instruction>

      <sections>
        <section id="functional" title="Functional Requirements" status="required" elicit="true">
          <instruction>
            Each Requirement will be a bullet markdown and an identifier sequence starting with FR.
            Format: "FR[number]: [requirement description]"

            Examples:
            - FR1: Users must be able to create an account using email or social login
            - FR6: The Todo List uses AI to detect and warn against potentially duplicate todo items that are worded differently
          </instruction>
        </section>

        <section id="non-functional" title="Non-Functional Requirements" status="required">
          <instruction>
            Each Requirement will be a bullet markdown and an identifier sequence starting with NFR.
            Format: "NFR[number]: [requirement description]"

            Examples:
            - NFR1: AWS service usage must aim to stay within free-tier limits where feasible
            - NFR2: Page load time must be under 2 seconds on 3G connections
          </instruction>
        </section>
      </sections>
    </section>

    <section id="ui-goals" title="User Interface Design Goals" status="optional" elicit="true" condition="PRD has UX/UI requirements">
      <instruction> Capture high-level UI/UX vision to guide Design Architect and to inform story creation. Steps: 1. Pre-fill all
        subsections with educated guesses based on project context 2. Present the complete rendered section to user 3. Clearly let the user
        know where assumptions were made 4. Ask targeted questions for unclear/missing elements or areas needing more specification 5. This
        is NOT detailed UI spec - focus on product vision and user goals <llm>
          <i>This is NOT detailed UI spec - focus on product vision and user goals</i>
        </llm>
      </instruction>

      <choices>
        <choice name="accessibility" options="[None, WCAG AA, WCAG AAA]" />
        <choice name="platforms" options="[Web Responsive, Mobile Only, Desktop Only, Cross-Platform]" />
      </choices>

      <sections>
        <section id="ux-vision" title="Overall UX Vision" status="required">
          <instruction>
            Describe the overall user experience vision:
            - Key design principles
            - User journey priorities
            - Emotional design goals
          </instruction>
        </section>

        <section id="interaction-paradigms" title="Key Interaction Paradigms" status="required">
          <instruction>
            Define primary interaction patterns:
            - Navigation approach
            - Data input methods
            - Feedback mechanisms
            - Mobile vs desktop interactions
          </instruction>
        </section>

        <section id="core-screens" title="Core Screens and Views" status="required">
          <instruction>
            From a product perspective, what are the most critical screens or views necessary to deliver the PRD values and goals?
            This is meant to be Conceptual High Level to Drive Rough Epic or User Stories.
            Keep conceptual and high-level to drive epics/stories.

            Examples:
            - Login Screen
            - Main Dashboard
            - Item Detail Page
            - Settings Page
            - Admin Panel
          </instruction>
        </section>

        <section id="accessibility" title="Accessibility Requirements" status="optional">
          <instruction>
            Specify accessibility standards:
            - None (not recommended)
            - WCAG AA (recommended minimum)
            - WCAG AAA (comprehensive)
            - Custom requirements
          </instruction>
        </section>

        <section id="branding" title="Branding Guidelines" status="optional">
          <instruction>
            Any known branding elements or style guides that must be incorporated?
            - Visual identity requirements
            - Tone and voice guidelines
            - Existing brand assets

            Examples:
            - "Replicate the look and feel of early 1900s black and white cinema, including animated effects replicating film damage or
            projector glitches during page or state transitions."
            - "Attached is the full color pallet and tokens for our corporate branding."
          </instruction>
        </section>

        <section id="target-platforms" title="Target Devices and Platforms" status="required">
          <instruction>
            Target Device and Platforms: {Web Responsive|Mobile Only|Desktop Only|Cross-Platform}
            Specify target platforms and any specific device requirements.

            Examples:
            - "Web Responsive, and all mobile platforms"
            - "iPhone Only"
            - "ASCII Windows Desktop"
          </instruction>
        </section>
      </sections>
    </section>

    <section id="technical-assumptions" title="Technical Requirements" status="required" elicit="true">
      <instruction> Gather high level technical decisions or anything we have already learned the user has told us during brainstorming or
        brief that will guide the Architect and produce a list of technical requirements. Steps: 1. Check if
        {project-root}/data/technical-preferences.yaml or an attached technical-preferences file exists - use it to pre-populate choices 2.
        Review project brief and previous PRD sections for any technical preferences or constraints already mentioned 3. If technical
        information exists, present draft technical choices for confirmation: "Based on the brief/requirements, I've identified these
        technical preferences. Do these align with your vision?" 4. If not known yet (don't assume), ask user about: language, any
        frameworks or starter templates, libraries, APIs, deployment environment. 5. For unknowns, offer guidance based on project goals and
        MVP scope keeping this PRD level of appropriate detail. 6. Document ALL technical choices with rationale (why this choice fits the
        project) - also if something is a hard requirement from the user, add it as as technical requirement [TR-#: description] 7. These
        become guidance for the Architect - keep this high level and focused on the foundational things that drive a PRD to facilitate
        conversation with the architect. <example description="GOOD Example of TR list at an appropriate level of detail">
          TR-1: Python for API
          TR-2: AWS Serverless
          TR-3: DynamoDB
          TR-4: 11 Labs Voice API
          TR-5: TypeScript with NextJS + React
          TR-6: Tailwind + ShadCN
        </example>
        <!-- IDE-INJECT-POINT: prd-technical-evaluation -->
      </instruction>
    </section>

    <section id="user-journeys" title="Core User Journeys" status="required" elicit="true">
      <instruction> Map the primary user flows that the MVP must support, regardless of interface type (UI, API, CLI, service integration).
        This bridges requirements and epics by showing how users will actually experience and derive value from the product. Steps: 1.
        Review project brief and previous sections for existing user information, personas, and use cases 2. If user types/journeys already
        identified, present draft journeys for confirmation and refinement 3. If missing, identify primary user types (end users,
        developers, admins, systems, other services) 4. Map end-to-end value realization journeys for each user type 5. Include all
        touchpoints: discovery, onboarding, core usage, troubleshooting, scaling 6. Connect journey steps to functional requirements
        (reference FR numbers) 7. Highlight critical decision points and potential friction/failure modes 8. This will inform epic
        sequencing to deliver user value incrementally <llm>
          <i>FIRST: Check project brief and previous PRD sections for existing user personas, target users, use cases, or user workflows</i>
          <i>IF user information exists: Present draft journeys based on existing information and ask "Based on the brief/requirements, I've
        mapped these user journeys. Do these align with your vision?"</i>
          <i>IF user information missing: ASK "Who are your primary users and how do they currently solve this problem?"</i>
          <i>ASK: "What does success look like from each user type's perspective?"</i>
          <i>ASK: "What are the most common ways users will discover, adopt, and integrate your product?"</i>
          <i>Focus on user experience and value realization, not technical implementation details</i>
          <i>For non-UI products: Consider developer experience, integration patterns, configuration flows</i>
          <i>For UI products: Include discovery, signup, core workflows, return usage patterns</i>
          <i>Reference existing functional requirements (FR numbers) when mapping journey steps</i>
        </llm>
        <!-- IDE-INJECT-POINT: prd-user-journey -->
      </instruction>

      <sections>
        <section id="primary-journey" title="Primary User Journey" status="required">
          <instruction>
            Map the most critical user flow from discovery to core value delivery.

            Format: User Entry Point → Key Actions/Touchpoints → Value Realization → Success Metrics

            Examples:
            - UI Product: Landing page → Signup → Onboarding → Core feature usage → Return engagement
            - API Product: Documentation discovery → Authentication setup → First API call → Integration success → Production usage
            - CLI Tool: Installation → Configuration → First command execution → Workflow automation → Advanced usage
            - Service: Service discovery → Integration → Configuration → Monitoring → Scaling
          </instruction>
        </section>

        <section id="secondary-journeys" title="Secondary User Journeys" status="optional">
          <instruction>
            Map additional user flows for different personas, use cases, or interaction patterns.

            Consider:
            - Different user types (end users vs. administrators vs. developers)
            - Alternative adoption paths (direct vs. referral vs. integration)
            - Advanced usage patterns (power users, enterprise needs)
            - Support/troubleshooting workflows
            - Migration or upgrade scenarios
          </instruction>
        </section>

        <section id="journey-insights" title="Journey Insights and Dependencies" status="required">
          <instruction>
            Analyze journeys to extract strategic insights:

            Critical Analysis:
            - What are the key user decision points and potential drop-off moments?
            - What constitutes the minimum viable journey (essential vs. nice-to-have steps)?
            - Which journey dependencies should inform epic sequencing?
            - What are the success metrics for each journey stage?
            - Where are the highest-risk integration or adoption points?
            - What external dependencies exist (third-party services, documentation, support)?

            Epic Sequencing Implications:
            - Which journey must be delivered first to prove core value?
            - How do journeys build upon each other?
            - What cross-cutting concerns (auth, monitoring, error handling) span multiple journeys?
          </instruction>
        </section>
      </sections>
    </section>

    <section id="out-of-scope" title="Out of Scope" status="required" elicit="true">
      <instruction> Define what is explicitly NOT included in this PRD to maintain MVP focus and prevent scope creep. This section helps
        keep the project lean by documenting features, integrations, or enhancements that may be valuable but are beyond the current scope.
        Categories to consider: - Features that don't directly serve the core goals - Advanced functionality that can be added later -
        Complex integrations not essential for MVP - Performance optimizations beyond basic requirements - UI/UX enhancements beyond
        functional needs - Administrative features not critical for initial users Format as bullet points with brief rationale: -
        [Feature/Functionality]: [Brief reason why it's out of scope] Examples: - Advanced analytics dashboard: Not essential for core user
        workflows, can be added post-MVP - Social media integrations: Additional complexity that doesn't serve primary use cases -
        Multi-language support: Single language sufficient for target market validation - Real-time notifications: Polling approach adequate
        for MVP user base <llm>
          <i>Be specific about what's excluded to prevent later confusion</i>
          <i>Reference goals and requirements to justify exclusions</i>
          <i>Consider future roadmap items that are tempting to include</i>
        </llm>
      </instruction>
    </section>

    <section id="epic-list" title="Epic List" status="required" elicit="true" creates-vars="epic_count,epic_titles">
      <instruction> Present a high-level list of all epics for user approval. Each epic should have a title and a short (1 sentence) goal
        statement. This allows the user to review the overall structure before diving into details. CRITICAL: Epics MUST be logically
        sequential following agile best practices: - Each epic should deliver a significant, end-to-end, fully deployable increment of
        testable functionality - Epic 1 must establish foundational project infrastructure (app setup, Git, CI/CD, core services) unless we
        are adding new functionality to an existing app, while also delivering an initial piece of functionality, even as simple as a
        health-check route or display of a simple canary page - remember this when we produce the stories for the first epic! - Each
        subsequent epic builds upon previous epics' functionality delivering major blocks of functionality that provide tangible value to
        users or business when deployed - Not every project needs multiple epics, an epic needs to deliver value. For example, an API
        completed can deliver value even if a UI is not complete and planned for a separate epic. - Err on the side of less epics, but let
        the user know your rationale and offer options for splitting them if it seems some are too large or focused on disparate things. -
        Cross Cutting Concerns should flow through epics and stories and not be final stories. For example, adding a logging framework as a
        last story of an epic, or at the end of a project as a final epic or story would be terrible as we would not have logging from the
        beginning. Examples: - "Epic 1: Foundation &amp; Core Infrastructure: Establish project setup, authentication, and basic user
        management" - "Epic 2: Core Business Entities: Create and manage primary domain objects with CRUD operations" - "Epic 3: User
        Workflows &amp; Interactions: Enable key user journeys and business processes" - "Epic 4: Reporting &amp; Analytics: Provide
        insights and data visualization for users" <!-- IDE-INJECT-POINT: prd-epic-optimization -->
        <i>Think about natural project progression and value delivery</i>
        <llm
          condition="once approved to go to the next section">
          <i>Set epic_count to the number of epics.</i>
          <i>Set epic_titles as array of epic titles for reference.</i>
        </llm>

      </instruction>
    </section>

    <repeat count="{{epic_count}}">
      <section id="epic-{{iteration}}" title="Epic {{iteration}}: {{epic_titles[iteration-1]}}"
        status="required" level="2" elicit="true">
        <instruction> Process 1 epic with all its stories as a complete review unit and then halt for elicitation. Provide expanded goal
          (2-3 sentences) describing objectives and value achieved. <llm>
            <i>Reference the epic list section for epic titles and goals</i>
          </llm>
        </instruction>

        <sections>
          <section id="epic-goal-{{iteration}}" title="Epic Goal" status="required" level="3">
            <instruction>
              Expand the epic goal into 2-3 sentences that clearly describe:
              - What functionality will be delivered
              - What value it provides to users/business
              - How it builds on previous epics (if applicable)
            </instruction>
          </section>

          <section id="stories-{{iteration}}" title="User Stories" status="required" level="3">
            <instruction>
              Create stories following user story format for this epic.
            </instruction>

            <repeat for="story">
              <section id="story-{{iteration}}-{{story_number}}" title="Story {{iteration}}.{{story_number}}: {{story_title}}"
                status="required" level="3">
                <instruction> Create story following user story format. CRITICAL STORY REQUIREMENTS: - Stories must be logically sequential
                  within epic - Each is a "vertical slice" of complete functionality - No dependencies on later stories/epics - Note any
                  direct prerequisite stories - Focus on "what" and "why" not "how" - Size for AI agent execution (2-4 hour scope) - Think
                  "junior developer working focused session" <llm>
                    <i>Ensure story is self-contained and completable in one session</i>
                  </llm>
                </instruction>

                <sections>
                  <section id="story-statement-{{iteration}}-{{story_number}}" title="User Story" status="required" level="4">
                    <instruction>
                      Write in standard format:
                      As a [user type],
                      I want [action/feature],
                      So that [benefit/value].
                    </instruction>
                  </section>

                  <section id="prerequisites-{{iteration}}-{{story_number}}" title="Prerequisites" status="optional" level="4">
                    <instruction>
                      List any stories that must be completed before this one:
                      - Reference by story number (e.g., "Requires Story 1.2")
                      - Explain the dependency briefly
                    </instruction>
                  </section>

                  <section id="acceptance-criteria-{{iteration}}-{{story_number}}" title="Acceptance Criteria" status="required" level="4">
                    <instruction> Define clear, comprehensive, and testable acceptance criteria that: - Precisely define what "done" means
                      from a functional perspective - Are unambiguous and serve as basis for verification - Include any critical
                      non-functional requirements from the PRD - Consider local testability for backend/data components - Specify UI/UX
                      requirements and framework adherence where applicable - Avoid cross-cutting concerns that should be in other stories
                      or PRD sections Number each criterion (AC1, AC2, etc.) <llm>
                        <i>Make criteria specific enough for automated testing where possible</i>
                      </llm>
                    </instruction>
                  </section>
                </sections>
              </section>
            </repeat>
          </section>

          <section id="epic-summary-{{iteration}}" title="Epic Summary" status="optional" level="3">
            <instruction> Provide epic completion summary: - Total number of stories - Key risks or dependencies - Success metrics for epic <!-- IDE-INJECT-POINT: prd-epic-stories-optimization -->
            </instruction>
          </section>
        </sections>
      </section>
    </repeat>

    <section id="checklist-results" title="Checklist Results Report" status="required">
      <instruction> Before running the checklist and drafting the prompts, offer to output the full updated PRD. If outputting it, confirm
        with the user that you will be proceeding to run the checklist and produce the report. Once the user confirms, execute the
        {project-root}/bmad/bmm/templates/prd-chkl.md and populate the results in this section. <!-- IDE-INJECT-POINT: prd-checklist-review -->
      </instruction>
    </section>

    <section id="next-steps" title="Next Steps" status="required">
      <instruction>
        Define immediate next steps and prompts for other agents. If there is a UX Component, suggest the user talk to the UX-Agent next, or
        else proceed directly to discussion with the architect. Highly recommend to the user that they start a new context chat with the
        chosen agent and use this document as an input when asked.
      </instruction>
    </section>
  </sections>

  <variables>
    <variable name="project_name" default="Unnamed Project" />
    <variable name="version" default="1.0" />
    <variable name="author" default="Product Manager" />
    <variable name="date" default="Current Date" />
    <variable name="epic_count" type="dynamic" source="section:epic-details" desc="Number of epics" />
    <variable name="epic_titles" type="dynamic" source="section:epic-details" desc="Array of epic titles for reference" />
  </variables>
</template>